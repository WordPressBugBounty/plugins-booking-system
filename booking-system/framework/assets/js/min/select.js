/*
 * Title                   : DOT Framework
 * File                    : framework/assets/js/min/select.js
 * Author                  : Dot on Paper
 * Copyright               : Â© 2021 Dot on Paper
 * Website                 : https://dotonpaper.net
 * Description             : Minified -> DOT Select jQuery plugin.
 */

(function($){$.fn.DOTSelect=function(options){"use strict";let Data={},Wrapper=this,ID="",id="",name="",classes="",onChange="",isDisabled=!1,isMultiple=!1,thisItem="",values=[],valuesKey=[],labels=[],search="",selectedOption=0,firstClick=!1,minSearchOptions=10,wasChanged=!1,methods={init:function(){return this.each(function(){options&&$.extend(Data,options),methods.parse()})},parse:function(){const e=$(Wrapper);let t;void 0!==options&&void 0!==options.search&&(search=options.search),id=void 0!==e.attr("id")?e.attr("id"):"",name=void 0!==e.attr("name")?e.attr("name"):"",classes=void 0!==e.attr("class")?e.attr("class"):"",onChange=void 0!==e.attr("onchange")?e.attr("onchange"):"",isDisabled=void 0!==e.attr("disabled"),thisItem=""!==id?"#"+id:'select[name*="'+name+'"]',isMultiple=$(thisItem+"[multiple]").length>0,ID=""!==id?id:name,selectedOption=isMultiple?[]:0,t=$(thisItem+" option"),t.each(function(){const e=$(this);values.push(e.attr("value")),valuesKey.push(methods.key(e.attr("value"))),labels.push(e.html()),e.is(":selected")&&(isMultiple?selectedOption.push(values.length-1):selectedOption=values.length-1)}),methods.display(),!isDisabled&&methods.events()},display:function(){const e=$(Wrapper);let t,s=[];for(s.push('<div id="dot-select-'+ID+'" class="dot-select '+(isMultiple?"dot-select-multiple":"dot-select-single")+(isDisabled?" dot-select-disabled":"")+(values.length>minSearchOptions?" dot-select-has-search":"")+(""!==classes?" "+classes:"")+'">'),s.push(' <input type="hidden" id="'+ID+'" name="'+name+'" value="'+(isMultiple?"":values[selectedOption])+'">'),isMultiple||(s.push(' <div class="dot-select-select">'),s.push('     <div class="dot-select-selection">'+(0!==values.length?labels[selectedOption]:"")+"</div>"),s.push('     <div class="dot-select-icon dot-select-icon-down dot-icon-action-arrow-down"></div>'),s.push('     <div class="dot-select-icon dot-select-icon-up dot-icon-action-arrow-up"></div>'),s.push(" </div>")),values.length>minSearchOptions&&!isDisabled&&(s.push(' <div class="dot-select-search">'),s.push('\t    <span class="dot-select-search-icon dot-icon-action-search"></span>'),s.push('\t    <input type="text" name="dot-select-search-'+ID+'" id="dot-select-search-'+ID+'" class="dot-select-search-input" value="" autocomplete="off" />'),s.push('\t    <a href="javascript:void(0)" class="dot-select-search-reset dot-icon-action-close-fill"></a>'),s.push(" </div>")),s.push(' <ul class="dot-select-list">'),t=0;t<values.length;t++)isMultiple?(s.push('     <li class="dot-select-list-item" title="'+labels[t]+'">'),s.push('         <input type="checkbox" name="dot-select-'+ID+"-"+valuesKey[t]+'" id="dot-select-'+ID+"-"+valuesKey[t]+'" data-value="'+values[t]+'" class="dot-select-checkbox"'+(isDisabled?' disabled="disabled"':"")+(-1!==$.inArray(t,selectedOption)?' checked="checked"':"")+" />"),s.push('         <label for="dot-select-'+ID+"-"+valuesKey[t]+'" class="dot-select-label">'+labels[t]+"</label>"),s.push("     </li>")):s.push('     <li class="dot-select-list-item'+(selectedOption===t?" dot-select-selected":"")+'" id="dot-select-'+ID+"-"+valuesKey[t]+'" data-value="'+values[t]+'" title="'+labels[t]+'">'+labels[t]+"</li>");s.push(" </ul>"),s.push("</div>"),e.replaceWith(s.join(""))},events:function(){const $document=$(document),$listItem=$("#dot-select-"+ID+" .dot-select-list-item"),$searchInput=$("#dot-select-"+ID+" .dot-select-search-input"),$searchReset=$("#dot-select-"+ID+" .dot-select-search-reset"),$select=$("#dot-select-"+ID+" .dot-select-select");isMultiple?($listItem.off("click"),$listItem.on("click",function(){const $checkbox=$("#dot-select-"+ID+" .dot-select-checkbox"),$ID=$("#"+ID);let selected=[],value;setTimeout(function(){$checkbox.each(function(){const e=$(this);e.is(":checked")&&(value=e.data("value"),selected.push(value))}),$ID.val(selected).trigger("change"),""!==onChange&&eval(onChange.replace(/this.value/g,"'"+selected.join(",")+"'"))},1)})):($document.on("mousedown",function(e){const t=$("#dot-select-"+ID+" .dot-select-list"),s=$("#dot-select-"+ID+" .dot-select-search"),l=$("#dot-select-"+ID+" .dot-select-select");0===$(e.target).parents("#dot-select-"+ID).length&&(l.removeClass("dot-select-focus"),t.removeAttr("style").removeClass("dot-select-visible"),s.removeClass("dot-select-visible"))}),$select.off("click"),$select.on("click",function(){$("#dot-select-"+ID+" .dot-select-list").hasClass("dot-select-visible")?methods.hide():(methods.hide(),methods.show())}),$listItem.off("click"),$listItem.on("click",function(){const $ID=$("#"+ID),$selection=$("#dot-select-"+ID+" .dot-select-selection"),$this=$(this);if($this.hasClass("dot-select-list-item-disabled"))return!1;$this.hasClass("dot-select-selected")||(wasChanged=!0,$listItem.removeClass("dot-select-selected"),$this.addClass("dot-select-selected"),$selection.html($this.html()),$ID.val($this.data("value")).trigger("change"),""!==onChange&&eval(onChange.replace(/this.value/g,"'"+$this.data("value")+"'"))),methods.hide()})),$searchInput.off("blur keyup paste"),$searchInput.on("blur keyup paste",function(){const e=$(this);methods.search(e.val())}),$searchReset.off("click"),$searchReset.on("click",function(){$searchInput.val(""),methods.search("")})},hide:function(){const e=$(".dot-select.dot-select-single .dot-select-list"),t=$(".dot-select.dot-select-single .dot-select-search");$(".dot-select.dot-select-single .dot-select-select").removeClass("dot-select-focus"),e.removeAttr("style").removeClass("dot-select-visible").scrollTop(0),t.removeClass("dot-select-visible")},key:function(e){return e.replace(/\//g,"-").replace(/ /g,"_").replace(/,/g,"-").replace(/;/g,"-").replace(/\./g,"-").replace(/:/g,"-").replace(/'/g,"-").replace(/"/g,"-").replace(/\(/g,"-").replace(/\)/g,"-").replace(/\[/g,"-").replace(/]/g,"-").replace(/\{/g,"-").replace(/}/g,"-")},search:function(e){const t=$("#dot-select-"+ID+" .dot-select-search-reset");let s,l,c,o,a=$("#dot-select-"+ID+" .dot-select-list-item");if(""===(e=e.toLowerCase())?t.removeClass("dot-select-visible"):t.addClass("dot-select-visible"),a.removeClass("dot-select-hidden"),""!==e)for(c=0;c<values.length;c++)l=labels[c].toLowerCase(),o=values[c],s=$(("#dot-select-"+ID+"-"+valuesKey[c]).replace(/\./g,"\\.")),a=isMultiple?s.parent():s,o=o.toLowerCase(),!(""===o||-1!==o.indexOf(e)&&"labels"!==search||-1!==l.indexOf(e)&&"values"!==search)&&a.addClass("dot-select-hidden")},show:function(){const e=$(document),t=$("#dot-select-"+ID+" .dot-select-list"),s=$("#dot-select-"+ID+" .dot-select-search"),l=$("#dot-select-"+ID+" .dot-select-select"),c=$("#dot-select-"+ID+" .dot-select-list-item.dot-select-selected"),o=e.height();let a,i,d,n,r;l.addClass("dot-select-focus"),t.addClass("dot-select-visible").removeAttr("style"),s.addClass("dot-select-visible").removeAttr("style"),i=t.height()+parseInt(t.css("border-top"))+parseInt(t.css("border-bottom"))+parseInt(t.css("margin-top"))+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom")),n=l.height()+parseInt(l.css("border-top"))+parseInt(l.css("border-bottom"))+parseInt(l.css("padding-top"))+parseInt(l.css("padding-bottom")),0===s.length?(a=n+i,l.offset().top+a>o&&t.attr("style","margin-top: "+-1*a+"px !important")):(d=s.height()+parseInt(s.css("border-top"))+parseInt(s.css("border-bottom"))+parseInt(s.css("margin-top"))+parseInt(s.css("padding-top"))+parseInt(s.css("padding-bottom")),a=n+i+d,l.offset().top+a>o&&(t.attr("style","margin-top: "+-1*(a-d)+"px !important"),s.attr("style","margin-top: "+-1*(n+d)+"px !important"))),r=c.position().top-c.height(),t.scrollTop(r),(wasChanged||firstClick)&&(r=c.position().top-c.height(),t.scrollTop(r)),firstClick||(firstClick=!0)}};return methods.init.apply(this)}})(jQuery);